<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Admin Portal UI</title>
  <style>
    :root {
      --navy: #102a5c;
      --navy-dark: #0b1e43;
      --text: #1b2430;
      --muted: #6a7689;
      --line: #dce2eb;
      --panel: #f5f7fb;
      --white: #ffffff;
      --accent: #2158d8;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--panel);
      color: var(--text);
    }

    .top-bar {
      background: linear-gradient(0deg, var(--navy-dark), var(--navy));
      color: var(--white);
      min-height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
      position: sticky;
      top: 0;
      z-index: 40;
    }

    .brand {
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .user-menu {
      position: relative;
    }

    .user-menu-button {
      appearance: none;
      border: none;
      background: transparent;
      color: var(--white);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 0.15rem 0;
      cursor: pointer;
      line-height: 1.2;
    }

    .user-menu-button:hover,
    .user-menu-button:focus-visible {
      opacity: 0.82;
    }

    .dropdown {
      position: absolute;
      right: 0;
      top: calc(100% + 0.5rem);
      background: var(--white);
      color: var(--text);
      min-width: 200px;
      border-radius: 12px;
      box-shadow: 0 12px 40px rgba(10, 23, 50, 0.18);
      border: 1px solid var(--line);
      overflow: hidden;
      display: none;
    }

    .dropdown[hidden] {
      display: none;
    }

    .dropdown.open {
      display: block;
    }

    .dropdown button {
      width: 100%;
      border: none;
      background: transparent;
      text-align: left;
      padding: 0.75rem 0.9rem;
      cursor: pointer;
      color: inherit;
    }

    .dropdown button:hover {
      background: #f0f4fa;
    }

    .main-nav {
      background: var(--white);
      border-bottom: 1px solid var(--line);
      padding: 0 1rem;
      display: flex;
      align-items: center;
      gap: 0.25rem;
      overflow-x: auto;
    }

    .nav-item {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 0.95rem 0.85rem;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      white-space: nowrap;
    }

    .nav-item:hover {
      color: var(--text);
      background: #f7f9fc;
    }

    .nav-item.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    main {
      width: 100%;
      margin: 0;
      padding: 0;
      background: var(--white);
      min-height: calc(100vh - 112px);
    }

    .page-shell {
      width: 100%;
      padding: 1.35rem 1.5rem 1.75rem;
      background: var(--white);
    }

    .page-title {
      margin: 0;
      font-size: 1.45rem;
    }

    .page-subtitle {
      margin: 0.35rem 0 1rem;
      color: var(--muted);
    }

    .page-header {
      margin-bottom: 1rem;
    }

    .filter-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.95rem;
      margin-bottom: 1rem;
    }

    .field-group label {
      display: block;
      font-size: 0.85rem;
      font-weight: 600;
      color: #4b586b;
      margin-bottom: 0.4rem;
    }

    .text-input {
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 0.68rem 0.75rem;
      font-size: 0.95rem;
    }

    .table-wrap {
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 1180px;
    }

    thead th {
      font-size: 0.77rem;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      color: var(--muted);
      background: #f8fbff;
    }

    th,
    td {
      text-align: left;
      padding: 0.75rem;
      border-bottom: 1px solid #ebeff5;
      white-space: nowrap;
    }

    tbody tr:hover {
      background: #fbfcff;
    }

    .account-link {
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
    }

    .account-link:hover {
      text-decoration: underline;
    }

    .actions-cell {
      position: relative;
    }

    .row-action-button {
      border: 1px solid #d5deec;
      background: #fff;
      border-radius: 8px;
      width: 34px;
      height: 32px;
      cursor: pointer;
      font-size: 1.1rem;
      line-height: 1;
      color: #4f5e76;
    }

    .row-action-menu {
      position: absolute;
      right: 0.65rem;
      top: calc(100% - 0.2rem);
      min-width: 220px;
      background: var(--white);
      border: 1px solid var(--line);
      border-radius: 10px;
      box-shadow: 0 12px 30px rgba(10, 23, 50, 0.15);
      overflow: hidden;
      z-index: 12;
      display: none;
    }

    .row-action-menu button {
      display: block;
      width: 100%;
      padding: 0.65rem 0.8rem;
      border: none;
      background: #fff;
      text-align: left;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .row-action-menu button:hover {
      background: #f0f5ff;
    }

    .row-action-menu.open {
      display: block;
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.8rem 0.2rem 0;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .pagination-controls {
      display: flex;
      gap: 0.5rem;
    }

    .page-btn {
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 8px;
      padding: 0.45rem 0.65rem;
      cursor: pointer;
    }

    .placeholder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 0.85rem;
    }


    .compliance-subnav {
      display: flex;
      align-items: center;
      gap: 1.25rem;
      flex-wrap: wrap;
      border-bottom: 1px solid var(--line);
      margin: 0.2rem 0 1.1rem;
    }

    .compliance-subnav-item {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 0.7rem 0.05rem;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      margin-bottom: -1px;
    }

    .compliance-subnav-item:hover {
      color: var(--text);
    }

    .compliance-subnav-item.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .compliance-panel {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #f8fbff;
      padding: 1rem;
    }

    .compliance-panel h3 {
      margin: 0;
      font-size: 1.05rem;
    }

    .compliance-panel p {
      margin: 0.45rem 0 0;
      color: var(--muted);
    }



    .archive-toolbar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.75rem;
      margin-bottom: 0.95rem;
    }

    .archive-summary {
      margin: 0 0 0.85rem;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .archive-status {
      font-size: 0.78rem;
      font-weight: 700;
    }

    .archive-status.approved {
      color: #0f6a35;
    }

    .archive-status.rejected {
      color: #8d1428;
    }

    .archive-status.submitted {
      color: #6c778a;
    }

    .archive-link {
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
    }

    .archive-link:hover {
      text-decoration: underline;
    }

    .archive-website-id {
      font-weight: 400;
    }

    .archive-table-wrap {
      background: #fbfcfe;
      border-color: #d7deea;
    }

    .archive-table thead th {
      text-transform: none;
      letter-spacing: normal;
      background: #f1f4f8;
    }

    .archive-table tbody tr {
      background: #fbfcfe;
    }

    .archive-table tbody tr:hover {
      background: #f5f7fb;
    }

    .json-payload-btn {
      border: 1px solid #d5deec;
      background: #fff;
      border-radius: 8px;
      padding: 0.35rem 0.6rem;
      font-size: 0.8rem;
      font-weight: 600;
      color: #33435e;
      cursor: pointer;
    }

    .json-payload-btn:hover {
      background: #eef4ff;
      border-color: #bed0f6;
    }

    .admin-tools-subnav {
      display: flex;
      align-items: center;
      gap: 1.1rem;
      flex-wrap: wrap;
      border-bottom: 1px solid var(--line);
      margin: 0.2rem 0 1.1rem;
    }

    .admin-tools-subnav-item {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 0.95rem;
      font-weight: 600;
      padding: 0.7rem 0.05rem;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      margin-bottom: -1px;
    }

    .admin-tools-subnav-item:hover {
      color: var(--text);
    }

    .admin-tools-subnav-item.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .admin-tools-panel {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #f8fbff;
      padding: 1rem;
    }

    .admin-tools-panel h3 {
      margin: 0;
      font-size: 1.05rem;
    }

    .admin-tools-panel p {
      margin: 0.5rem 0 1rem;
      color: var(--muted);
    }

    .admin-tools-toolbar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 0.75rem;
      margin-bottom: 0.95rem;
    }

    .admin-tools-summary {
      margin: 0 0 0.85rem;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .admin-tools-subtable-title {
      margin: 1rem 0 0.55rem;
      font-size: 1rem;
    }

    .admin-tools-subtable-title:first-of-type {
      margin-top: 0.25rem;
    }


    .crud-cell {
      text-align: center;
      min-width: 88px;
    }

    .crud-action-btn {
      border: 1px solid #d5deec;
      background: #fff;
      border-radius: 8px;
      padding: 0.3rem 0.55rem;
      font-size: 0.8rem;
      font-weight: 600;
      color: #33435e;
      cursor: pointer;
    }

    .crud-action-btn:hover {
      background: #eef4ff;
      border-color: #bed0f6;
    }

    .crud-action-btn.editing {
      background: #fff4b8;
      border-color: #ebc856;
      color: #5f4a00;
    }

    .admin-tools-table td[contenteditable='true'] {
      outline: 2px solid #ebc856;
      outline-offset: -2px;
      background: #fffdf2;
    }

    .status-pill {
      display: inline-block;
      border-radius: 999px;
      padding: 0.2rem 0.5rem;
      font-size: 0.78rem;
      font-weight: 600;
      background: #eceff4;
      color: #556177;
    }

    .status-pill.active {
      background: #def7e7;
      color: #1f6b3a;
    }

    .admin-tools-table {
      min-width: 2100px;
    }

    .calculators-table-wrap {
      border: 1px solid var(--line);
      border-radius: 10px;
      overflow-x: auto;
      background: #fff;
    }

    .calculators-table {
      width: 100%;
      border-collapse: collapse;
      min-width: 980px;
    }

    .calculators-table thead th {
      background: #c5ccd6;
      color: #2e3a4a;
      font-size: 0.8rem;
      text-transform: none;
      letter-spacing: 0;
    }

    .calculators-table tbody tr {
      background: #fff8cf;
    }

    .calculators-table td,
    .calculators-table th {
      border-bottom: 1px solid #e9ddaa;
      padding: 0.72rem;
      vertical-align: top;
    }

    .calc-checkbox-cell {
      width: 54px;
      text-align: center;
    }


    .placeholder-card {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 0.9rem;
      background: #f8faff;
    }

    .placeholder-card h3 {
      margin: 0;
      font-size: 1rem;
    }

    .placeholder-card p {
      margin: 0.45rem 0 0;
      color: var(--muted);
    }

    @media (max-width: 900px) {
      .filter-row {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 640px) {

      .top-bar,
      .page-shell {
        padding-left: 0.85rem;
        padding-right: 0.85rem;
      }

      .brand {
        font-size: 0.95rem;
      }
    }
  </style>
</head>

<body>
  <header class="top-bar">
    <div class="brand">Project Admin Portal</div>
    <div class="user-menu">
      <button class="user-menu-button" id="userMenuButton" aria-expanded="false" aria-haspopup="true">jdoe_admin
        ▾</button>
      <div class="dropdown" id="userDropdown" role="menu" aria-label="User menu" hidden>
        <button type="button" role="menuitem">My Profile</button>
        <button type="button" role="menuitem">Preferences</button>
        <button type="button" role="menuitem">Sign Out</button>
      </div>
    </div>
  </header>

  <nav class="main-nav" aria-label="Primary">
    <button class="nav-item active" data-page="Accounts">Accounts</button>
    <button class="nav-item" data-page="Users">Users</button>
    <button class="nav-item" data-page="Compliance">Compliance</button>
    <button class="nav-item" data-page="Content">Content</button>
    <button class="nav-item" data-page="Websites">Websites</button>
    <button class="nav-item" data-page="Locator">Locator</button>
    <button class="nav-item" data-page="Video">Video</button>
    <button class="nav-item" data-page="Admin Tools">Admin Tools</button>
  </nav>

  <main>
    <section id="pageContainer" class="page-shell"></section>
  </main>

  <script>
    const navItems = document.querySelectorAll('.nav-item');
    const pageContainer = document.getElementById('pageContainer');
    const userMenuButton = document.getElementById('userMenuButton');
    const userDropdown = document.getElementById('userDropdown');
    const uiVersion = 'compliance-v2';

    document.body.setAttribute('data-ui-version', uiVersion);

    const accountRows = [
      {
        accountName: 'Northwind Retail Group',
        parentAccount: 'Global Commerce Holdings',
        subAccounts: 4,
        userCount: 58,
        ownerEmail: 'owner@northwind.com',
        createdOn: '2024-01-17'
      },
      {
        accountName: 'Summit Health Partners',
        parentAccount: 'Summit Enterprises',
        subAccounts: 2,
        userCount: 31,
        ownerEmail: 'admin@summithealth.com',
        createdOn: '2023-09-05'
      },
      {
        accountName: 'Blue Harbor Logistics',
        parentAccount: 'Blue Harbor Group',
        subAccounts: 7,
        userCount: 102,
        ownerEmail: 'ops@blueharbor.io',
        createdOn: '2022-11-28'
      },
      {
        accountName: 'Evergreen Academy',
        parentAccount: 'Evergreen Education Network',
        subAccounts: 3,
        userCount: 44,
        ownerEmail: 'support@evergreenacademy.edu',
        createdOn: '2024-04-10'
      }
    ];

    const placeholderSections = {
      Users: [
        ['User Directory', 'Browse users, roles, and status snapshots.'],
        ['Access Requests', 'Pending approvals for user permissions.'],
        ['Audit Trail', 'User login and privilege activity.']
      ],
      Content: [
        ['Publishing Queue', 'Track drafts, approvals, and publish states.'],
        ['Asset Library', 'Manage reusable media and documents.'],
        ['Editorial Notes', 'Capture collaboration notes and next steps.']
      ],
      Websites: [
        ['Site Health', 'Uptime and environment status indicators.'],
        ['Release History', 'Recent deployments and rollback options.'],
        ['Domain Settings', 'Placeholder controls for DNS and routing.']
      ],
      Locator: [
        ['Region Filters', 'Prototype controls to narrow location data.'],
        ['Map Panel', 'Reserved area for map visualization.'],
        ['Location Table', 'List of managed locations and tags.']
      ],
      Video: [
        ['Upload Queue', 'Monitor incoming video processing jobs.'],
        ['Channel Configuration', 'Manage playback targets and metadata.'],
        ['Compliance Checks', 'Track review status and quality gates.']
      ],
      'Admin Tools': [
        ['System Settings', 'Centralized admin-level configuration options.'],
        ['Job Scheduler', 'Control recurring maintenance automation.'],
        ['Permissions Matrix', 'Visualize and tune role-based access.']
      ]
    };



    const pageHeaderTitles = {
      Accounts: 'Account Management',
      Users: 'User Management',
      Compliance: 'Compliance',
      Content: 'Content Management',
      Websites: 'Website Management',
      Locator: 'Locator',
      Video: 'Video',
      'Admin Tools': 'Admin Tools'
    };

    const complianceTabs = [
      {
        name: 'Workflows',
        description: 'Review and configure compliance workflows for onboarding and policy checks.'
      },
      {
        name: 'Compliance Queue',
        description: 'Track pending compliance reviews, status updates, and assigned owners.'
      },
      {
        name: 'Advisor Queue',
        description: 'Monitor advisor requests requiring guidance, remediation, or escalation.'
      },
      {
        name: 'Archive',
        description: 'Access historical compliance records, completed tasks, and audit references.'
      }
    ];

    const defaultComplianceTab = 'Archive';
    const adminToolsEditRows = {};

    const adminToolsTabs = [
      {
        name: 'BAS Roles',
        description: 'Manage BAS role records for lower-environment testing and quick permission cleanup.',
        searchPlaceholder: 'Search role name, key, or description',
        searchFields: ['roleName', 'roleKey', 'description'],
        filters: [
          {
            id: 'assignmentBand',
            label: 'Users Assigned',
            allLabel: 'All assignment counts',
            options: ['0-10', '11-25', '26+']
          }
        ],
        columns: [
          { key: 'roleName', label: 'Role Name' },
          { key: 'roleKey', label: 'Role Key' },
          { key: 'description', label: 'Description' },
          { key: 'usersAssigned', label: 'Users Assigned' },
          { key: 'updatedOn', label: 'Updated On' }
        ],
        rows: [
          { roleName: 'Financial Advisor', roleKey: 'FIN_ADVISOR', description: 'Advisory workspace access for portfolio planning and client actions.', usersAssigned: 22, assignmentBand: '11-25', updatedOn: '2026-02-08' },
          { roleName: 'Staff Admin', roleKey: 'STAFF_ADMIN', description: 'Internal staff administration access for lower-environment data maintenance.', usersAssigned: 8, assignmentBand: '0-10', updatedOn: '2026-02-07' },
          { roleName: 'Compliance Reviewer', roleKey: 'COMPLIANCE_REVIEW', description: 'Can review queued compliance artifacts and submit approval decisions.', usersAssigned: 15, assignmentBand: '11-25', updatedOn: '2026-02-05' },
          { roleName: 'Compliance Admin', roleKey: 'COMPLIANCE_ADMIN', description: 'Manages compliance configuration, escalations, and remediation routing.', usersAssigned: 6, assignmentBand: '0-10', updatedOn: '2026-02-04' },
          { roleName: 'Program Admin', roleKey: 'PROGRAM_ADMIN', description: 'Configures program-level metadata and onboarding defaults for testing.', usersAssigned: 12, assignmentBand: '11-25', updatedOn: '2026-02-03' },
          { roleName: 'Developer', roleKey: 'DEVELOPER', description: 'Engineering access for integration validation and sandbox troubleshooting.', usersAssigned: 31, assignmentBand: '26+', updatedOn: '2026-02-01' }
        ]
      },
      {
        name: 'BAS Users',
        description: 'Find and clean up BAS user test records, role assignments, and account links quickly.',
        searchPlaceholder: 'Search email, user id, or name',
        searchFields: ['userId', 'name', 'email'],
        filters: [
          {
            id: 'environment',
            label: 'Environment',
            allLabel: 'All environments',
            options: ['DEV', 'QA', 'UAT']
          },
          {
            id: 'state',
            label: 'Status',
            allLabel: 'All statuses',
            options: ['Active', 'Disabled']
          }
        ],
        columns: [
          { key: 'userId', label: 'User ID' },
          { key: 'name', label: 'Name' },
          { key: 'email', label: 'Email' },
          { key: 'role', label: 'Roles' },
          { key: 'accountId', label: 'BAS Account ID' },
          { key: 'state', label: 'Status' }
        ],
        rows: [
          { userId: 'usr-10012', name: 'Talia Morrow', email: 'talia.morrow+qa@internal.local', role: 'Staff Admin', accountId: 'BAS-ACCT-4421', environment: 'QA', state: 'Active' },
          { userId: 'usr-10041', name: 'Jesse Patel', email: 'jesse.patel+dev@internal.local', role: 'Developer', accountId: 'BAS-ACCT-1180', environment: 'DEV', state: 'Disabled' },
          { userId: 'usr-10103', name: 'Morgan Ellis', email: 'morgan.ellis+uat@internal.local', role: 'Compliance Reviewer', accountId: 'BAS-ACCT-9008', environment: 'UAT', state: 'Disabled' },
          { userId: 'usr-10155', name: 'Nora Castillo', email: 'nora.castillo+qa@internal.local', role: 'Program Admin', accountId: 'BAS-ACCT-7774', environment: 'QA', state: 'Active' }
        ]
      },
      {
        name: 'BAS Accounts',
        description: 'Review and maintain BAS account test data used by staff across lower environments.',
        searchPlaceholder: 'Search account id, account name, or owner',
        searchFields: ['accountId', 'accountName', 'owner'],
        filters: [
          {
            id: 'environment',
            label: 'Environment',
            allLabel: 'All environments',
            options: ['DEV', 'QA', 'UAT']
          },
          {
            id: 'health',
            label: 'Health',
            allLabel: 'All health states',
            options: ['Healthy', 'Needs Cleanup', 'Archived']
          }
        ],
        columns: [
          { key: 'accountId', label: 'Account ID' },
          { key: 'accountName', label: 'Account Name' },
          { key: 'owner', label: 'Owner' },
          { key: 'linkedUsers', label: 'Linked Users' },
          { key: 'environment', label: 'Environment' },
          { key: 'health', label: 'Health' },
          { key: 'updatedOn', label: 'Updated On' }
        ],
        rows: [
          { accountId: 'BAS-ACCT-4421', accountName: 'Northwind QA Sandbox', owner: 'Identity Ops', linkedUsers: 14, environment: 'QA', health: 'Healthy', updatedOn: '2026-02-07' },
          { accountId: 'BAS-ACCT-1180', accountName: 'Blue Harbor Dev Seed', owner: 'Automation Team', linkedUsers: 7, environment: 'DEV', health: 'Needs Cleanup', updatedOn: '2026-02-03' },
          { accountId: 'BAS-ACCT-9008', accountName: 'Evergreen UAT Replay', owner: 'Support Tools', linkedUsers: 2, environment: 'UAT', health: 'Archived', updatedOn: '2026-01-28' },
          { accountId: 'BAS-ACCT-7774', accountName: 'Summit Regression QA', owner: 'QA Automation', linkedUsers: 19, environment: 'QA', health: 'Needs Cleanup', updatedOn: '2026-02-05' }
        ]
      },
      {
        name: 'Wix Websites',
        description: 'Manage synced Wix websites and operational metadata.',
        enableCrud: false,
        searchPlaceholder: 'Search name, display name, owner account ID, or folder ID',
        searchFields: ['name', 'displayName', 'ownerAccountId', 'folderId', 'namespace'],
        filters: [
          {
            id: 'published',
            label: 'Published',
            allLabel: 'All publish states',
            options: ['Yes', 'No']
          },
          {
            id: 'isPremium',
            label: 'Is Premium',
            allLabel: 'All premium states',
            options: ['Yes', 'No']
          },
          {
            id: 'blocked',
            label: 'Blocked',
            allLabel: 'All block states',
            options: ['Yes', 'No']
          },
          {
            id: 'editorType',
            label: 'Editor Type',
            allLabel: 'All editor types',
            options: ['Studio', 'Editor']
          }
        ],
        columns: [
          { key: 'name', label: 'Name' },
          { key: 'displayName', label: 'Display Name' },
          { key: 'published', label: 'Published' },
          { key: 'dateCreated', label: 'Date Created' },
          { key: 'lastUpdate', label: 'Last Update' },
          { key: 'isPremium', label: 'Is Premium' },
          { key: 'viewUrl', label: 'View URL' },
          { key: 'blocked', label: 'Blocked' },
          { key: 'ownerAccountId', label: 'Owner Account ID' },
          { key: 'contributorAccountIds', label: 'Contributor Account IDs' },
          { key: 'folderId', label: 'Folder ID' },
          { key: 'editorType', label: 'Editor Type' },
          { key: 'namespace', label: 'Namespace' }
        ],
        rows: [
          { name: 'west-coast-primary', displayName: 'West Coast Primary', published: 'Yes', dateCreated: '2025-12-10', lastUpdate: '2026-02-08', isPremium: 'Yes', viewUrl: 'https://west.example.internal', blocked: 'No', ownerAccountId: 'A7H29KQ8D-4F12-9B8C-72D3-5E19A2B4C6D7', contributorAccountIds: 'B3F10H2KQ-98A7-4C11-8D3E-2A9F41B6D8C2, C9L24N7PZ-65D1-4A22-9F8E-7B3C12D5E6A4', folderId: 'F8A31D2LQ-77B3-4D11-92C8-1E7F4A5B9D0C', editorType: 'Studio', namespace: 'Wix' },
          { name: 'east-hub-site', displayName: 'East Hub Website', published: 'No', dateCreated: '2025-11-04', lastUpdate: '2026-02-06', isPremium: 'No', viewUrl: 'https://east.example.internal', blocked: 'No', ownerAccountId: 'D2M67R4TY-1C45-4B9D-8A2E-3F6A90B1C5D7', contributorAccountIds: 'E5Q18S2UV-83D2-4E19-9C4B-5A7F31D8G6H2', folderId: 'G7K25T9WP-41A8-4F20-8B7D-9C2E6L3M1N5R', editorType: 'Editor', namespace: 'Wix' },
          { name: 'midwest-service-portal', displayName: 'Midwest Service Portal', published: 'Yes', dateCreated: '2025-09-19', lastUpdate: '2026-02-05', isPremium: 'Yes', viewUrl: 'https://midwest.example.internal', blocked: 'Yes', ownerAccountId: 'H4P39V8YX-52E6-4A71-9D0B-6L2Q84R5T1U3', contributorAccountIds: 'J8R42W1ZA-73B9-4C20-8F1D-4M6N92P3Q7S5, K2T61X4BC-95C3-4D11-9A7E-8R1U53V6W0Y2', folderId: 'L6V54Y3DE-29D4-4B88-7C2F-0T9W15X8Z4A6', editorType: 'Studio', namespace: 'Wix' }
        ]
      },
      {
        name: 'Wix Roles',
        description: 'Review pre-defined Wix roles and staff-created custom role profiles.',
        preDefinedRoles: [
          { roleName: 'Owner', description: 'Full control across website configuration, billing, publishing, roles, and connected integrations.', permissions: 'NO Restricitons' },
          { roleName: 'Account Admin', description: 'Can manage account-level settings, team membership, and operational controls for linked websites.', permissions: 'Account' },
          { roleName: 'Admin', description: 'Can update key settings, publishing preferences, and user access within assigned scopes.', permissions: 'SIte' },
          { roleName: 'Website Manager', description: 'Manages page structure, navigation, SEO settings, and publishing readiness for sites.', permissions: 'SIte' },
          { roleName: 'Website Designer', description: 'Edits layout, theme, styling, and visual components without account administration rights.', permissions: 'SIte' }
        ],
        customRoles: [
          { roleName: 'Fianancial Advisor', description: 'Supports advisor-specific content updates and review workflows for assigned web properties.', permissions: 'SIte' },
          { roleName: 'Program Admin', description: 'Coordinates program-level pages, release updates, and scoped collaborator permissions.', permissions: 'Account' },
          { roleName: 'Developer', description: 'Maintains technical implementations, integrations, and troubleshooting in lower environments.', permissions: 'NO Restricitons' },
          { roleName: 'Home Office Executive', description: 'Read/review access to executive dashboards and strategic website reporting areas.', permissions: 'Account' },
          { roleName: 'Content Editor', description: 'Creates and edits content blocks, media, and draft updates for designated sites.', permissions: 'SIte' },
          { roleName: 'Assistant', description: 'Supports operational updates and limited content edits under guided team oversight.', permissions: 'SIte' },
          { roleName: 'Marketing Support', description: 'Updates campaign assets, promotion sections, and marketing copy across approved pages.', permissions: 'SIte' }
        ]
      },
      {
        name: 'Wix Folders',
        description: 'Manage Wix folder records used for organizing sites and content in lower environments.',
        enableCrud: false,
        searchPlaceholder: 'Search folder name or path',
        searchFields: ['folderName', 'path'],
        filters: [
          {
            id: 'siteCountBand',
            label: 'Site Count',
            allLabel: 'All site counts',
            options: ['0-10', '11-25', '26+']
          }
        ],
        columns: [
          { key: 'folderName', label: 'Folder Name' },
          { key: 'dateCreated', label: 'Date Created' },
          { key: 'lastUpdated', label: 'Last Updated' },
          { key: 'siteCount', label: 'Site Count' },
          { key: 'path', label: 'Path' }
        ],
        rows: [
          { folderName: 'BAS Marketing', dateCreated: '2025-10-12', lastUpdated: '2026-02-08', siteCount: 14, path: '\\BAS Marketing', siteCountBand: '11-25' },
          { folderName: 'Enterprise Demo Sites', dateCreated: '2025-09-03', lastUpdated: '2026-02-05', siteCount: 8, path: '\\Enterprise Demo sites', siteCountBand: '0-10' },
          { folderName: 'CFP Websites', dateCreated: '2025-07-21', lastUpdated: '2026-02-02', siteCount: 31, path: '\\CFP Websites', siteCountBand: '26+' }
        ]
      },
      {
        name: 'Calculators',
        description: 'Functional table for automated calculator validation records in lower environments.',
        rows: [
          { checked: false, status: 'Deployed', description: 'automated test validation for content type CALCUALTOR created on 2026-02-01', expiryDate: '2026-03-01', publishDate: '2026-02-02' },
          { checked: false, status: 'Redeployed', description: 'automated test validation for content type CALCUALTOR created on 2026-02-02', expiryDate: '2026-03-04', publishDate: '2026-02-03' },
          { checked: true, status: 'Deployed', description: 'automated test validation for content type CALCUALTOR created on invalid-date', expiryDate: 'invalid-date', publishDate: '2026-02-04' },
          { checked: false, status: 'Redeployed', description: 'Annuity Calculator', expiryDate: '2026-03-10', publishDate: '2026-02-05' },
          { checked: true, status: 'Deployed', description: 'Mortgage Calculator', expiryDate: '2026-03-11', publishDate: '2026-02-06' },
          { checked: false, status: 'Redeployed', description: 'automated test validation for content type CALCUALTOR created on 2026-02-06', expiryDate: '2026-03-13', publishDate: 'invalid-date' },
          { checked: false, status: 'Deployed', description: 'automated test validation for content type tax CALCUALTOR created on 2026-02-07', expiryDate: '2026-03-14', publishDate: '2026-02-08' },
          { checked: false, status: 'Redeployed', description: 'automated test validation for content type savings CALCUALTOR created on invalid-date', expiryDate: '2026-03-15', publishDate: '2026-02-09' },
          { checked: true, status: 'Deployed', description: 'automated test validation for content type CALCUALTOR created on 2026-02-09', expiryDate: '2026-03-18', publishDate: '2026-02-10' },
          { checked: false, status: 'Redeployed', description: 'automated test validation for content type college CALCUALTOR created on 2026-02-10', expiryDate: 'invalid-date', publishDate: '2026-02-11' }
        ]
      }
    ];

    const defaultAdminToolsTab = 'BAS Roles';

    const complianceArchiveRows = [
      {
        event_date: '2026-01-16',
        status: 'Approved',
        file_type: 'PDF',
        submitter_id: 'ariana.holt@westwindcapital.com',
        approver_id: 'Derek.Mills',
        bas_account_id: 'WestWind Capital',
        wix_account_id: 'A9K3P2-B7Q4-M5R8T1',
        site_id: 'A7F2-9KLM-4Q8P-T2X',
        website_id: 'West Coast Primary',
        revision: 'Rev 1',
        revision_url: 'https://example.com/revision/4821',
        diff_json: '{"header":"updated","hero":"copy-change"}'
      },
      {
        event_date: '2026-01-14',
        status: 'Submitted',
        file_type: 'PDF',
        submitter_id: 'ariana.holt@westwindcapital.com',
        approver_id: 'Derek.Mills',
        bas_account_id: 'WestWind Capital',
        wix_account_id: 'A9K3P2-B7Q4-M5R8T1',
        site_id: 'A7F2-9KLM-4Q8P-T2X',
        website_id: 'West Coast Primary',
        revision: 'Rev 1',
        revision_url: 'https://example.com/revision/4821',
        diff_json: '{"header":"updated","hero":"copy-change"}'
      },
      {
        event_date: '2026-01-13',
        status: 'Rejected',
        file_type: 'PDF',
        submitter_id: 'jordan.kim@easthubadvisors.com',
        approver_id: 'Celine.Brooks',
        bas_account_id: 'EastHub Advisors',
        wix_account_id: 'J4M8N2-C1R7-P9T5V3',
        site_id: 'Q3W8-R2TY-7PLM-K9V',
        website_id: 'East Hub Website',
        revision: 'Rev 2',
        revision_url: 'https://example.com/revision/4833',
        diff_json: '{"notes":"missing legal disclaimer"}'
      },
      {
        event_date: '2026-01-11',
        status: 'Submitted',
        file_type: 'PDF',
        submitter_id: 'jordan.kim@easthubadvisors.com',
        approver_id: 'Celine.Brooks',
        bas_account_id: 'EastHub Advisors',
        wix_account_id: 'J4M8N2-C1R7-P9T5V3',
        site_id: 'Q3W8-R2TY-7PLM-K9V',
        website_id: 'East Hub Website',
        revision: 'Rev 2',
        revision_url: 'https://example.com/revision/4833',
        diff_json: '{"notes":"missing legal disclaimer"}'
      },
      {
        event_date: '2026-01-10',
        status: 'Approved',
        file_type: 'PDF',
        submitter_id: 'nia.patel@midwestservicegroup.com',
        approver_id: 'Marco.Sloan',
        bas_account_id: 'Midwest Service Group',
        wix_account_id: 'R8L2C5-D3F7-H1J9K4',
        site_id: 'M5N2-Z8XC-1VBP-D4R',
        website_id: 'Midwest Service Portal',
        revision: 'Rev 3',
        revision_url: 'https://example.com/revision/4794',
        diff_json: '{"footer":"policy-link"}'
      },
      {
        event_date: '2026-01-08',
        status: 'Submitted',
        file_type: 'PDF',
        submitter_id: 'nia.patel@midwestservicegroup.com',
        approver_id: 'Marco.Sloan',
        bas_account_id: 'Midwest Service Group',
        wix_account_id: 'R8L2C5-D3F7-H1J9K4',
        site_id: 'M5N2-Z8XC-1VBP-D4R',
        website_id: 'Midwest Service Portal',
        revision: 'Rev 3',
        revision_url: 'https://example.com/revision/4794',
        diff_json: '{"footer":"policy-link"}'
      },
      {
        event_date: '2026-01-07',
        status: 'Rejected',
        file_type: 'PDF',
        submitter_id: 'leo.foster@southernopsllc.com',
        approver_id: 'Celine.Brooks',
        bas_account_id: 'Southern Operations LLC',
        wix_account_id: 'T6V3B1-N8M4-Q2W7E5',
        site_id: 'B2NM-7QWE-5RTY-L8K',
        website_id: 'Southern Operations',
        revision: 'Rev 4',
        revision_url: 'https://example.com/revision/4766',
        diff_json: '{"compliance":"needs updated disclosures"}'
      },
      {
        event_date: '2026-01-05',
        status: 'Submitted',
        file_type: 'PDF',
        submitter_id: 'leo.foster@southernopsllc.com',
        approver_id: 'Celine.Brooks',
        bas_account_id: 'Southern Operations LLC',
        wix_account_id: 'T6V3B1-N8M4-Q2W7E5',
        site_id: 'B2NM-7QWE-5RTY-L8K',
        website_id: 'Southern Operations',
        revision: 'Rev 4',
        revision_url: 'https://example.com/revision/4766',
        diff_json: '{"compliance":"needs updated disclosures"}'
      },
      {
        event_date: '2026-01-04',
        status: 'Approved',
        file_type: 'PDF',
        submitter_id: 'maya.chen@northdigitalpartners.com',
        approver_id: 'Derek.Mills',
        bas_account_id: 'North Digital Partners',
        wix_account_id: 'P5S9D2-K4L1-Z7X3C8',
        site_id: 'H9JK-2PLM-6QWE-N3T',
        website_id: 'Northern Digital HQ',
        revision: 'Rev 5',
        revision_url: 'https://example.com/revision/4702',
        diff_json: '{"hero":"updated cta spacing"}'
      },
      {
        event_date: '2026-01-02',
        status: 'Submitted',
        file_type: 'PDF',
        submitter_id: 'maya.chen@northdigitalpartners.com',
        approver_id: 'Derek.Mills',
        bas_account_id: 'North Digital Partners',
        wix_account_id: 'P5S9D2-K4L1-Z7X3C8',
        site_id: 'H9JK-2PLM-6QWE-N3T',
        website_id: 'Northern Digital HQ',
        revision: 'Rev 5',
        revision_url: 'https://example.com/revision/4702',
        diff_json: '{"hero":"updated cta spacing"}'
      }
    ];

    function setUserMenuOpen(isOpen) {
      userDropdown.classList.toggle('open', isOpen);
      userDropdown.hidden = !isOpen;
      userMenuButton.setAttribute('aria-expanded', String(isOpen));
    }

    function closeAllRowMenus() {
      document.querySelectorAll('.row-action-menu.open').forEach((menu) => menu.classList.remove('open'));
    }

    function attachRowMenuEvents() {
      const rowButtons = document.querySelectorAll('.row-action-button');

      rowButtons.forEach((button) => {
        button.addEventListener('click', (event) => {
          event.stopPropagation();
          const targetMenu = button.nextElementSibling;
          const isOpen = targetMenu.classList.contains('open');
          closeAllRowMenus();
          if (!isOpen) {
            targetMenu.classList.add('open');
          }
        });
      });
    }

    function renderAccountsView() {
      const tableRows = accountRows
        .map(
          (row) => `
              <tr>
                <td><a class="account-link" href="#">${row.accountName}</a></td>
                <td>${row.parentAccount}</td>
                <td>${row.subAccounts}</td>
                <td>${row.userCount}</td>
                <td>${row.ownerEmail}</td>
                <td>${row.createdOn}</td>
                <td class="actions-cell">
                  <button class="row-action-button" aria-label="Open account actions">⋯</button>
                  <div class="row-action-menu" role="menu" aria-label="Row actions">
                    <button type="button">Edit account</button>
                    <button type="button">Add sub account</button>
                    <button type="button">Add user</button>
                    <button type="button">Bind site to account</button>
                  </div>
                </td>
              </tr>
            `
        )
        .join('');

      pageContainer.innerHTML = `
          <div class="page-header">
            <h1 class="page-title">Account Management</h1>
          </div>
          <div class="filter-row">
            <div class="field-group">
              <label for="accountSearch">Account Name</label>
              <input id="accountSearch" class="text-input" type="text" placeholder="Search by account" />
            </div>
            <div class="field-group">
              <label for="userSearch">User Search</label>
              <input id="userSearch" class="text-input" type="text" placeholder="Search by name or email address" />
            </div>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Account Name</th>
                  <th>Parent Account</th>
                  <th>Sub Accounts</th>
                  <th>User Count</th>
                  <th>Account Owner Email</th>
                  <th>Account Creation Date</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>${tableRows}</tbody>
            </table>
          </div>

          <div class="pagination">
            <span>Showing 1-4 of 42 accounts</span>
            <div class="pagination-controls">
              <button class="page-btn" type="button">Previous</button>
              <button class="page-btn" type="button">1</button>
              <button class="page-btn" type="button">2</button>
              <button class="page-btn" type="button">3</button>
              <button class="page-btn" type="button">Next</button>
            </div>
          </div>
        `;

      attachRowMenuEvents();
    }

    function renderPlaceholderView(sectionName) {
      const sectionCards = placeholderSections[sectionName] || [];
      const cards = sectionCards
        .map(([title, desc]) => `<article class="placeholder-card"><h3>${title}</h3><p>${desc}</p></article>`)
        .join('');

      const headerTitle = pageHeaderTitles[sectionName] || sectionName;

      pageContainer.innerHTML = `
          <div class="page-header">
            <h1 class="page-title">${headerTitle}</h1>
            <p class="page-subtitle">This section is ready for the next phase of UI buildout.</p>
          </div>
          <div class="placeholder-grid">${cards}</div>
        `;
    }

    function renderArchiveTableRows(filteredRows) {
      return filteredRows
        .map((row) => {
          const statusClass = row.status.toLowerCase();
          const revisionUrlCell = row.revision_url
            ? `<a href="${row.revision_url}" class="archive-link" target="_blank" rel="noopener noreferrer">Revision Link</a>`
            : '—';
          const diffCell = row.diff_json ? '<button type="button" class="json-payload-btn">Open JSON</button>' : '—';

          return `
              <tr>
                <td>${row.event_date}</td>
                <td class="archive-website-id">${row.website_id}</td>
                <td>${row.submitter_id}</td>
                <td>${row.approver_id}</td>
                <td><span class="archive-status ${statusClass}">${row.status}</span></td>
                <td>${row.bas_account_id}</td>
                <td>${row.wix_account_id}</td>
                <td>${row.site_id}</td>
                <td>${row.revision}</td>
                <td>${row.file_type || '—'}</td>
                <td>${revisionUrlCell}</td>
                <td>${diffCell}</td>
              </tr>
            `;
        })
        .join('');
    }

    function applyArchiveFilters() {
      const queryInput = document.getElementById('archiveSearchInput');
      const statusFilter = document.getElementById('archiveStatusFilter');
      const fileTypeFilter = document.getElementById('archiveFileTypeFilter');
      const tableBody = document.getElementById('archiveTableBody');
      const resultsSummary = document.getElementById('archiveResultsSummary');

      const query = queryInput.value.trim().toLowerCase();
      const selectedStatus = statusFilter.value;
      const selectedFileType = fileTypeFilter.value;

      const filteredRows = complianceArchiveRows
        .filter((row) => {
        const matchesQuery =
          !query ||
          row.submitter_id.toLowerCase().includes(query) ||
          row.approver_id.toLowerCase().includes(query) ||
          row.website_id.toLowerCase().includes(query) ||
          row.bas_account_id.toLowerCase().includes(query) ||
          row.wix_account_id.toLowerCase().includes(query) ||
          row.site_id.toLowerCase().includes(query);

          const matchesStatus = !selectedStatus || row.status === selectedStatus;
          const matchesFileType = !selectedFileType || row.file_type === selectedFileType;

          return matchesQuery && matchesStatus && matchesFileType;
        })
        .sort((a, b) => new Date(b.event_date) - new Date(a.event_date));

      tableBody.innerHTML = filteredRows.length
        ? renderArchiveTableRows(filteredRows)
        : '<tr><td colspan="12">No archive records match your filters.</td></tr>';

      resultsSummary.textContent = `Showing ${filteredRows.length} of ${complianceArchiveRows.length} compliance archive records`;
    }

    function attachArchiveFilterEvents() {
      const queryInput = document.getElementById('archiveSearchInput');
      const statusFilter = document.getElementById('archiveStatusFilter');
      const fileTypeFilter = document.getElementById('archiveFileTypeFilter');

      [queryInput, statusFilter, fileTypeFilter].forEach((element) => {
        element.addEventListener('input', applyArchiveFilters);
        element.addEventListener('change', applyArchiveFilters);
      });
    }

    function renderArchiveView() {
      const compliancePanel = document.getElementById('compliancePanel');
      compliancePanel.innerHTML = `
          <div class="page-header">
            <h2 class="page-title">Compliance Archive</h2>
            <p class="page-subtitle">Search submitted, approved, and rejected compliance review events ordered newest to oldest.</p>
          </div>

          <div class="archive-toolbar" aria-label="Archive search and filters">
            <div class="field-group">
              <label for="archiveSearchInput">Search archive records</label>
              <input id="archiveSearchInput" class="text-input" type="search" placeholder="Search submitter email, approver, website, or account IDs" />
            </div>
            <div class="field-group">
              <label for="archiveStatusFilter">Status</label>
              <select id="archiveStatusFilter" class="text-input">
                <option value="">All statuses</option>
                <option value="Submitted">Submitted</option>
                <option value="Approved">Approved</option>
                <option value="Rejected">Rejected</option>
              </select>
            </div>
            <div class="field-group">
              <label for="archiveFileTypeFilter">File type</label>
              <select id="archiveFileTypeFilter" class="text-input">
                <option value="">All file types</option>
                <option value="PDF">PDF</option>
              </select>
            </div>
          </div>

          <p class="archive-summary" id="archiveResultsSummary"></p>

          <div class="table-wrap archive-table-wrap">
            <table class="archive-table">
              <thead>
                <tr>
                  <th>Event Date</th>
                  <th>Website ID (Name)</th>
                  <th>Submitter ID</th>
                  <th>Approver ID</th>
                  <th>Status</th>
                  <th>BAS Account ID</th>
                  <th>Wix Account ID</th>
                  <th>Site MSID</th>
                  <th>Revision</th>
                  <th>File Type</th>
                  <th>Revision URL</th>
                  <th>JSON Diff Data</th>
                </tr>
              </thead>
              <tbody id="archiveTableBody"></tbody>
            </table>
          </div>
        `;

      attachArchiveFilterEvents();
      applyArchiveFilters();
    }

    function renderCompliancePanel(tabName) {
      if (tabName === 'Archive') {
        renderArchiveView();
        return;
      }

      const selectedTab = complianceTabs.find((tab) => tab.name === tabName) || complianceTabs[0];
      const compliancePanel = document.getElementById('compliancePanel');
      compliancePanel.innerHTML = `
          <h3>${selectedTab.name}</h3>
          <p>${selectedTab.description}</p>
        `;
    }

    function attachComplianceTabEvents() {
      const complianceSubnavItems = document.querySelectorAll('.compliance-subnav-item');

      complianceSubnavItems.forEach((item) => {
        item.addEventListener('click', () => {
          const selectedTabName = item.dataset.complianceTab;
          complianceSubnavItems.forEach((button) => {
            button.classList.toggle('active', button === item);
            button.setAttribute('aria-selected', String(button === item));
          });
          renderCompliancePanel(selectedTabName);
        });
      });
    }

    function renderComplianceView() {
      const subnavButtons = complianceTabs
        .map(
          (tab, index) => `
              <button
                class="compliance-subnav-item${tab.name === defaultComplianceTab ? ' active' : ''}"
                type="button"
                data-compliance-tab="${tab.name}"
                role="tab"
                aria-selected="${tab.name === defaultComplianceTab ? 'true' : 'false'}"
              >
                ${tab.name}
              </button>
            `
        )
        .join('');

      pageContainer.innerHTML = `
          <div class="page-header">
            <h1 class="page-title">Compliance</h1>
          </div>
          <div class="compliance-subnav" aria-label="Compliance sub navigation" role="tablist">
            ${subnavButtons}
          </div>
          <section class="compliance-panel" id="compliancePanel"></section>
        `;

      renderCompliancePanel(defaultComplianceTab);
      attachComplianceTabEvents();
    }

    function getAdminToolsRowId(tabConfig, row, index) {
      if (row.roleKey) {
        return row.roleKey;
      }

      if (row.userId) {
        return row.userId;
      }

      if (row.accountId) {
        return row.accountId;
      }

      if (row.name) {
        return row.name;
      }

      return `${tabConfig.name}-${index}`;
    }

    function renderAdminToolsTableRows(tabConfig, rows) {
      const showCrud = tabConfig.enableCrud !== false;
      const hideCreateReadActions = tabConfig.name === 'BAS Roles' || tabConfig.name === 'BAS Users';
      const showCreateReadActions = showCrud && !hideCreateReadActions;
      return rows
        .map((row, rowIndex) => {
          const rowId = getAdminToolsRowId(tabConfig, row, rowIndex);
          const editableRows = adminToolsEditRows[tabConfig.name] || new Set();
          const isEditing = editableRows.has(rowId);
          const valueCells = tabConfig.columns
            .map((column) => {
              const value = row[column.key];
              if (column.key === 'viewUrl' && value) {
                return `<td><a href="${value}" class="archive-link" target="_blank" rel="noopener noreferrer">${value}</a></td>`;
              }

              if (!isEditing && column.key === 'state' && tabConfig.name === 'BAS Users') {
                const stateClass = String(value).toLowerCase() === 'active' ? 'active' : '';
                return `<td data-column-key="${column.key}"><span class="status-pill ${stateClass}">${value}</span></td>`;
              }

              if (isEditing) {
                return `<td contenteditable="true" data-column-key="${column.key}">${value}</td>`;
              }

              return `<td data-column-key="${column.key}">${value}</td>`;
            })
            .join('');

          return `
              <tr data-row-id="${rowId}">
                ${valueCells}
                ${showCrud
                  ? `
                ${showCreateReadActions ? '<td class="crud-cell"><button class="crud-action-btn" type="button">Create</button></td>' : ''}
                ${showCreateReadActions ? '<td class="crud-cell"><button class="crud-action-btn" type="button">Read</button></td>' : ''}
                <td class="crud-cell"><button class="crud-action-btn update-btn${isEditing ? ' editing' : ''}" type="button">Update</button></td>
                ${tabConfig.name === 'BAS Users' ? '<td class="crud-cell"><button class="crud-action-btn" type="button">Disable</button></td>' : ''}
                <td class="crud-cell"><button class="crud-action-btn" type="button">Delete</button></td>
                `
                  : ''}
              </tr>
            `;
        })
        .join('');
    }

    function applyAdminToolsFilters() {
      const panel = document.getElementById('adminToolsPanel');
      if (!panel) {
        return;
      }

      const selectedTabName = panel.dataset.activeAdminToolsTab;
      const tabConfig = adminToolsTabs.find((tab) => tab.name === selectedTabName) || adminToolsTabs[0];
      const showCrud = tabConfig.enableCrud !== false;
      const hideCreateReadActions = tabConfig.name === 'BAS Roles' || tabConfig.name === 'BAS Users';
      const showCreateReadActions = showCrud && !hideCreateReadActions;
      const actionColumnCount = !showCrud ? 0 : tabConfig.name === 'BAS Users' ? 3 : showCreateReadActions ? 4 : 2;
      const searchInput = document.getElementById('adminToolsSearchInput');
      const tableBody = document.getElementById('adminToolsTableBody');
      const resultsSummary = document.getElementById('adminToolsResultsSummary');

      if (!searchInput || !tableBody || !resultsSummary) {
        return;
      }

      const query = searchInput.value.trim().toLowerCase();
      const filterSelections = tabConfig.filters.reduce((accumulator, filter) => {
        const filterElement = document.getElementById(`adminToolsFilter-${filter.id}`);
        accumulator[filter.id] = filterElement ? filterElement.value : '';
        return accumulator;
      }, {});

      const filteredRows = tabConfig.rows.filter((row) => {
        const matchesQuery =
          !query ||
          tabConfig.searchFields.some((fieldName) => String(row[fieldName]).toLowerCase().includes(query));

        const matchesAllFilters = tabConfig.filters.every((filter) => {
          const selectedValue = filterSelections[filter.id];
          return !selectedValue || String(row[filter.id]) === selectedValue;
        });

        return matchesQuery && matchesAllFilters;
      });

      tableBody.innerHTML = filteredRows.length
        ? renderAdminToolsTableRows(tabConfig, filteredRows)
        : `<tr><td colspan="${tabConfig.columns.length + actionColumnCount}">No ${tabConfig.name.toLowerCase()} records match your filters.</td></tr>`;

      if (showCrud) {
        attachAdminToolsCrudEvents(tabConfig);
      }

      resultsSummary.textContent = `Showing ${filteredRows.length} of ${tabConfig.rows.length} ${tabConfig.name.toLowerCase()} records`;
    }

    function attachAdminToolsFilterEvents(tabConfig) {
      const searchInput = document.getElementById('adminToolsSearchInput');
      if (!searchInput) {
        return;
      }

      const elements = [
        searchInput,
        ...tabConfig.filters
          .map((filter) => document.getElementById(`adminToolsFilter-${filter.id}`))
          .filter(Boolean)
      ];

      elements.forEach((element) => {
        element.addEventListener('input', applyAdminToolsFilters);
        element.addEventListener('change', applyAdminToolsFilters);
      });
    }

    function attachAdminToolsCrudEvents(tabConfig) {
      const tableBody = document.getElementById('adminToolsTableBody');
      if (!tableBody) {
        return;
      }

      tableBody.querySelectorAll('.update-btn').forEach((button) => {
        button.addEventListener('click', () => {
          const rowElement = button.closest('tr');
          if (!rowElement) {
            return;
          }

          const rowId = rowElement.dataset.rowId;
          const editableRows = adminToolsEditRows[tabConfig.name] || new Set();
          const isEditing = editableRows.has(rowId);
          const matchingRow = tabConfig.rows.find((row, rowIndex) => getAdminToolsRowId(tabConfig, row, rowIndex) === rowId);

          if (!matchingRow) {
            return;
          }

          if (!isEditing) {
            editableRows.add(rowId);
            adminToolsEditRows[tabConfig.name] = editableRows;
            applyAdminToolsFilters();
            return;
          }

          rowElement.querySelectorAll('td[data-column-key]').forEach((cell) => {
            const key = cell.dataset.columnKey;
            matchingRow[key] = cell.textContent.trim();
          });

          editableRows.delete(rowId);
          adminToolsEditRows[tabConfig.name] = editableRows;
          applyAdminToolsFilters();
        });
      });
    }

    function renderCalculatorsPanel(selectedTab) {
      const panel = document.getElementById('adminToolsPanel');
      const tableRows = selectedTab.rows
        .map(
          (row, index) => `
              <tr>
                <td class="calc-checkbox-cell"><input type="checkbox" aria-label="Select calculator row ${index + 1}" ${row.checked ? 'checked' : ''} /></td>
                <td>${row.status}</td>
                <td>${row.description}</td>
                <td>${row.expiryDate}</td>
                <td>${row.publishDate}</td>
              </tr>
            `
        )
        .join('');

      panel.dataset.activeAdminToolsTab = selectedTab.name;
      panel.innerHTML = `
          <h3>${selectedTab.name}</h3>
          <p>${selectedTab.description}</p>
          <div class="calculators-table-wrap">
            <table class="calculators-table">
              <thead>
                <tr>
                  <th scope="col"></th>
                  <th scope="col">Calcualtor Status</th>
                  <th scope="col">Description</th>
                  <th scope="col">Expiry Date</th>
                  <th scope="col">Publish Date</th>
                </tr>
              </thead>
              <tbody>
                ${tableRows}
              </tbody>
            </table>
          </div>
        `;
    }

    function renderWixRolesPanel(selectedTab) {
      const panel = document.getElementById('adminToolsPanel');
      const renderRows = (rows) =>
        rows
          .map(
            (row) => `
                <tr>
                  <td>${row.roleName}</td>
                  <td>${row.description}</td>
                  <td>${row.permissions}</td>
                </tr>
              `
          )
          .join('');

      panel.dataset.activeAdminToolsTab = selectedTab.name;
      panel.innerHTML = `
          <h3>${selectedTab.name}</h3>
          <p>${selectedTab.description}</p>

          <h4 class="admin-tools-subtable-title">Pre defined roles</h4>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th scope="col">Role name</th>
                  <th scope="col">Description</th>
                  <th scope="col">Permissions</th>
                </tr>
              </thead>
              <tbody>
                ${renderRows(selectedTab.preDefinedRoles)}
              </tbody>
            </table>
          </div>

          <h4 class="admin-tools-subtable-title">Custom Roles</h4>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th scope="col">Role name</th>
                  <th scope="col">Description</th>
                  <th scope="col">Permissions</th>
                </tr>
              </thead>
              <tbody>
                ${renderRows(selectedTab.customRoles)}
              </tbody>
            </table>
          </div>
        `;
    }

    function renderAdminToolsPanel(tabName) {
      const selectedTab = adminToolsTabs.find((tab) => tab.name === tabName) || adminToolsTabs[0];

      if (selectedTab.name === 'Wix Roles') {
        renderWixRolesPanel(selectedTab);
        return;
      }

      if (selectedTab.name === 'Calculators') {
        renderCalculatorsPanel(selectedTab);
        return;
      }

      const panel = document.getElementById('adminToolsPanel');
      const filterFields = selectedTab.filters
        .map(
          (filter) => `
              <div class="field-group">
                <label for="adminToolsFilter-${filter.id}">${filter.label}</label>
                <select id="adminToolsFilter-${filter.id}" class="text-input">
                  <option value="">${filter.allLabel}</option>
                  ${filter.options.map((option) => `<option value="${option}">${option}</option>`).join('')}
                </select>
              </div>
            `
        )
        .join('');

      const headerCells = selectedTab.columns
        .map((column) => `<th scope="col">${column.label}</th>`)
        .join('');
      const showCrud = selectedTab.enableCrud !== false;
      const hideCreateReadActions = selectedTab.name === 'BAS Roles' || selectedTab.name === 'BAS Users';
      const showCreateReadActions = showCrud && !hideCreateReadActions;

      panel.dataset.activeAdminToolsTab = selectedTab.name;
      panel.innerHTML = `
          <h3>${selectedTab.name}</h3>
          <p>${selectedTab.description}</p>
          <div class="admin-tools-toolbar" aria-label="${selectedTab.name} search and filters">
            <div class="field-group">
              <label for="adminToolsSearchInput">Search</label>
              <input id="adminToolsSearchInput" class="text-input" type="search" placeholder="${selectedTab.searchPlaceholder}" />
            </div>
            ${filterFields}
          </div>
          <p class="admin-tools-summary" id="adminToolsResultsSummary"></p>
          <div class="table-wrap">
            <table class="admin-tools-table">
              <thead>
                <tr>
                  ${headerCells}
                  ${showCrud
                    ? `
                  ${showCreateReadActions ? '<th scope="col">Create</th>' : ''}
                  ${showCreateReadActions ? '<th scope="col">Read</th>' : ''}
                  <th scope="col">Update</th>
                  ${selectedTab.name === 'BAS Users' ? '<th scope="col">Disable</th>' : ''}
                  <th scope="col">Delete</th>
                  `
                    : ''}
                </tr>
              </thead>
              <tbody id="adminToolsTableBody"></tbody>
            </table>
          </div>
        `;

      attachAdminToolsFilterEvents(selectedTab);
      applyAdminToolsFilters();
    }

    function attachAdminToolsTabEvents() {
      const items = document.querySelectorAll('.admin-tools-subnav-item');
      items.forEach((item) => {
        item.addEventListener('click', () => {
          const selectedTabName = item.dataset.adminToolsTab;
          items.forEach((button) => {
            button.classList.toggle('active', button === item);
            button.setAttribute('aria-selected', String(button === item));
          });
          renderAdminToolsPanel(selectedTabName);
        });
      });
    }

    function renderAdminToolsView() {
      const subnavButtons = adminToolsTabs
        .map(
          (tab) => `
              <button
                class="admin-tools-subnav-item${tab.name === defaultAdminToolsTab ? ' active' : ''}"
                type="button"
                data-admin-tools-tab="${tab.name}"
                role="tab"
                aria-selected="${tab.name === defaultAdminToolsTab ? 'true' : 'false'}"
              >
                ${tab.name}
              </button>
            `
        )
        .join('');

      pageContainer.innerHTML = `
          <div class="page-header">
            <h1 class="page-title">Admin Tools</h1>
          </div>
          <div class="admin-tools-subnav" aria-label="Admin tools sub navigation" role="tablist">
            ${subnavButtons}
          </div>
          <section class="admin-tools-panel" id="adminToolsPanel"></section>
        `;

      renderAdminToolsPanel(defaultAdminToolsTab);
      attachAdminToolsTabEvents();
    }

    function renderSection(sectionName) {
      closeAllRowMenus();
      if (sectionName === 'Accounts') {
        renderAccountsView();
        return;
      }
      if (sectionName === 'Compliance') {
        renderComplianceView();
        return;
      }
      if (sectionName === 'Admin Tools') {
        renderAdminToolsView();
        return;
      }
      renderPlaceholderView(sectionName);
    }

    navItems.forEach((button) => {
      button.addEventListener('click', () => {
        navItems.forEach((item) => item.classList.remove('active'));
        button.classList.add('active');
        renderSection(button.dataset.page);
      });
    });

    setUserMenuOpen(false);

    userMenuButton.addEventListener('click', () => {
      const isOpen = userMenuButton.getAttribute('aria-expanded') === 'true';
      setUserMenuOpen(!isOpen);
    });

    document.addEventListener('click', (event) => {
      if (!event.target.closest('.user-menu')) {
        setUserMenuOpen(false);
      }

      if (!event.target.closest('.actions-cell')) {
        closeAllRowMenus();
      }
    });

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape') {
        setUserMenuOpen(false);
        closeAllRowMenus();
      }
    });

    renderSection('Accounts');
  </script>
</body>

</html>
